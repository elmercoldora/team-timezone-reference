<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Team Time Zone Converter</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 20px; }
    h1 { font-size: 18px; margin: 0 0 10px; }
    .sub { font-size: 13px; color: #444; margin: 0 0 16px; line-height: 1.4; max-width: 860px; }

    .grid { display: grid; grid-template-columns: repeat(2, minmax(260px, 1fr)); gap: 12px; max-width: 860px; }
    label { display:block; font-size: 12px; color: #333; margin-bottom: 4px; }
    select, input { width: 100%; padding: 10px; font-size: 13px; }

    .stack { display: grid; grid-template-columns: 1fr; gap: 12px; max-width: 420px; }
    .actions { max-width: 860px; margin-top: 14px; display: flex; gap: 10px; align-items: center; }
    button { padding: 10px 14px; font-size: 13px; cursor: pointer; }

    .card { max-width: 860px; margin-top: 16px; border: 1px solid #ddd; border-radius: 10px; padding: 14px; }
    .big { font-size: 16px; margin: 0 0 8px; }
    .small { font-size: 12px; color: #555; margin: 0; line-height: 1.45; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    .hint { font-size: 12px; color: #666; margin-left: 8px; }
  </style>
</head>
<body>
  <h1>Team Time Zone Converter</h1>
  <p class="sub">
    Choose your location (“From”), enter your date/time, then choose the target location (“To”).
    Click <b>Convert</b> to see the exact time in the target location (DST-aware).
  </p>

  <div class="grid">
    <div>
      <label for="fromLoc">From (your location)</label>
      <select id="fromLoc"></select>
    </div>

    <div>
      <label for="toLoc">To (target location)</label>
      <select id="toLoc"></select>
    </div>

    <div class="stack">
      <div>
        <label for="date">Date (From location)</label>
        <input id="date" type="date" />
      </div>
      <div>
        <label for="time">Time (From location)</label>
        <input id="time" type="time" step="60" />
      </div>
    </div>

    <div></div>
  </div>

  <div class="actions">
    <button id="convertBtn">Convert</button>
    <span class="hint">Tip: enter the time you intend to set in your own location.</span>
  </div>

  <div class="card">
    <p class="big" id="resultMain">Select your locations, date, and time — then click Convert.</p>
    <p class="small" id="resultSub"></p>
  </div>

<script>
  // Team locations (DST handled by IANA TZ rules)
  const LOCATIONS = [
    // Canada
    { label: "Canada — Ontario (Toronto, Eastern Time)", tz: "America/Toronto" },
    { label: "Canada — Nova Scotia (Halifax, Atlantic Time)", tz: "America/Halifax" },
    { label: "Canada — British Columbia (Vancouver, Pacific Time)", tz: "America/Vancouver" },
    { label: "Canada — Alberta (Edmonton, Mountain Time)", tz: "America/Edmonton" },

    // Mexico (defaulting to Mexico City)
    { label: "Mexico — Mexico City (Central Time)", tz: "America/Mexico_City" },

    // Other countries
    { label: "Brazil — São Paulo", tz: "America/Sao_Paulo" },
    { label: "Kenya — Nairobi", tz: "Africa/Nairobi" },
    { label: "Philippines — Manila", tz: "Asia/Manila" },
  ];

  const fromLoc = document.getElementById("fromLoc");
  const toLoc = document.getElementById("toLoc");
  const dateEl = document.getElementById("date");
  const timeEl = document.getElementById("time");
  const convertBtn = document.getElementById("convertBtn");

  const resultMain = document.getElementById("resultMain");
  const resultSub = document.getElementById("resultSub");

  function initSelects() {
    for (const loc of LOCATIONS) {
      const o1 = document.createElement("option");
      o1.value = loc.tz;
      o1.textContent = loc.label;
      fromLoc.appendChild(o1);

      const o2 = document.createElement("option");
      o2.value = loc.tz;
      o2.textContent = loc.label;
      toLoc.appendChild(o2);
    }

    // Default: From Ontario (Toronto), To Philippines (Manila)
    fromLoc.value = "America/Toronto";
    toLoc.value = "Asia/Manila";
  }

  function getLabelByTZ(tz) {
    return LOCATIONS.find(x => x.tz === tz)?.label || tz;
  }

  function formatInTZ(dateObj, tz) {
    return new Intl.DateTimeFormat("en-US", {
      timeZone: tz,
      weekday: "short",
      year: "numeric",
      month: "short",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      hour12: true,
      timeZoneName: "short",
    }).format(dateObj);
  }

  // Build a UTC Date representing "YYYY-MM-DD HH:MM" interpreted in fromTZ.
  function buildInstantFromInput(fromTZ, yyyy, mm, dd, HH, MM) {
    let d = new Date(Date.UTC(yyyy, mm - 1, dd, HH, MM, 0));

    for (let i = 0; i < 6; i++) {
      const parts = new Intl.DateTimeFormat("en-CA", {
        timeZone: fromTZ,
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        hour12: false
      }).formatToParts(d);

      const get = (type) => parts.find(p => p.type === type)?.value;
      const curY = Number(get("year"));
      const curM = Number(get("month"));
      const curD = Number(get("day"));
      const curH = Number(get("hour"));
      const curMin = Number(get("minute"));

      const target = Date.UTC(yyyy, mm - 1, dd, HH, MM, 0);
      const current = Date.UTC(curY, curM - 1, curD, curH, curMin, 0);

      const diffMs = target - current;
      if (diffMs === 0) return d;

      d = new Date(d.getTime() + diffMs);
    }
    return d;
  }

  function convert() {
    const fromTZ = fromLoc.value;
    const toTZ = toLoc.value;

    if (!dateEl.value || !timeEl.value) {
      resultMain.textContent = "Please select a date and time first.";
      resultSub.textContent = "";
      return;
    }

    const [yyyy, mm, dd] = dateEl.value.split("-").map(Number);
    const [HH, MM] = timeEl.value.split(":").map(Number);

    const instant = buildInstantFromInput(fromTZ, yyyy, mm, dd, HH, MM);

    const fromLabel = getLabelByTZ(fromTZ);
    const toLabel = getLabelByTZ(toTZ);

    const fromText = formatInTZ(instant, fromTZ);
    const toText = formatInTZ(instant, toTZ);

    resultMain.textContent = `In ${toLabel}, it’s ${toText}.`;
    resultSub.innerHTML =
      `You entered: <span class="mono">${fromText}</span> (${fromLabel})<br/>` +
      `Converted to: <span class="mono">${toText}</span> (${toLabel})`;
  }

  // Defaults: set date/time to "now" in From TZ (user still clicks Convert)
  function setDefaultsToNowInFromTZ() {
    const fromTZ = fromLoc.value;
    const now = new Date();

    const parts = new Intl.DateTimeFormat("en-CA", {
      timeZone: fromTZ,
      year: "numeric", month: "2-digit", day: "2-digit",
      hour: "2-digit", minute: "2-digit", hour12: false
    }).formatToParts(now);

    const get = (t) => parts.find(p => p.type === t)?.value;
    dateEl.value = `${get("year")}-${get("month")}-${get("day")}`;
    timeEl.value = `${get("hour")}:${get("minute")}`;
  }

  convertBtn.addEventListener("click", convert);

  // If From changes, refresh defaults so inputs match the selected From zone
  fromLoc.addEventListener("change", () => setDefaultsToNowInFromTZ());

  initSelects();
  setDefaultsToNowInFromTZ();
</script>
</body>
</html>
