<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Team Time Zone Converter</title>

  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 20px; background: #fff; color: #111; }
    h1 { font-size: 18px; margin-bottom: 8px; }
    .sub { font-size: 13px; color: #444; margin-bottom: 16px; max-width: 860px; line-height: 1.4; }

    .grid { display: grid; grid-template-columns: repeat(2, minmax(260px, 1fr)); gap: 12px; max-width: 860px; }
    label { display: block; font-size: 12px; margin-bottom: 4px; color: #333; }
    select, input { width: 100%; padding: 10px; font-size: 13px; border: 1px solid #ccc; border-radius: 6px; }

    .stack { display: grid; grid-template-columns: 1fr; gap: 12px; max-width: 420px; }

    .actions { margin-top: 14px; max-width: 860px; display: flex; gap: 12px; align-items: center; }
    button { padding: 10px 16px; font-size: 13px; border: 1px solid #999; border-radius: 6px; background: #f6f6f6; cursor: pointer; }
    button:hover { background: #eee; }
    .hint { font-size: 12px; color: #666; }

    .card { max-width: 860px; margin-top: 18px; border: 1px solid #ddd; border-radius: 10px; padding: 14px; background: #fafafa; }
    .big { font-size: 16px; margin-bottom: 8px; }
    .small { font-size: 12px; color: #555; line-height: 1.45; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    .good { color: #1b7a1b; font-weight: 600; }
    .bad { color: #b00020; font-weight: 600; }
  </style>
</head>

<body>
  <h1>Team Time Zone Converter</h1>

  <p class="sub">
    Choose your location (“From”), enter your date and time, then choose the target
    location (“To”). Click <b>Convert</b> to see the exact time in the other location.
    Daylight saving time is handled automatically. The result also shows if the converted time
    is within or outside typical team working hours.
  </p>

  <div class="grid">
    <div>
      <label for="fromLoc">From (your location)</label>
      <select id="fromLoc"></select>
    </div>

    <div>
      <label for="toLoc">To (target location)</label>
      <select id="toLoc"></select>
    </div>

    <div class="stack">
      <div>
        <label for="date">Date (From location)</label>
        <input id="date" type="date" />
      </div>

      <div>
        <label for="time">Time (From location)</label>
        <input id="time" type="time" step="60" />
      </div>
    </div>

    <div></div>
  </div>

  <div class="actions">
    <button id="convertBtn">Convert</button>
    <span class="hint">Enter the time you plan to set in your own location.</span>
  </div>

  <div class="card">
    <div class="big" id="resultMain">Select locations, date, and time — then click Convert.</div>
    <div class="small" id="resultSub"></div>
  </div>

<script>
  /* ==========================================================
     TEAM LOCATIONS (DST handled automatically via IANA TZ rules)
     ========================================================== */

  const LOCATIONS = [
    // Canada
    { label: "Canada — Ontario (Toronto, Eastern Time)", tz: "America/Toronto" },
    { label: "Canada — Nova Scotia (Halifax, Atlantic Time)", tz: "America/Halifax" },
    { label: "Canada — British Columbia (Vancouver, Pacific Time)", tz: "America/Vancouver" },
    { label: "Canada — Alberta (Edmonton, Mountain Time)", tz: "America/Edmonton" },

    // Mexico
    { label: "Mexico — Central Time (Mexico City)", tz: "America/Mexico_City" },

    // Other countries
    { label: "Brazil — São Paulo", tz: "America/Sao_Paulo" },
    { label: "Kenya — Nairobi", tz: "Africa/Nairobi" },
    { label: "Philippines — Manila", tz: "Asia/Manila" },
    { label: "India — New Delhi (IST)", tz: "Asia/Kolkata" }
  ];

  /* ==========================================================
     WORKING HOURS WINDOWS (local time)
     - "Within" means startHour <= hour < endHour
     - Everything else is "Outside"
     ========================================================== */

  const DEFAULT_WORK_WINDOW = { start: 9, end: 17 }; // 9:00–17:00

  const WORK_WINDOWS = {
    // Philippines: ends at 11 PM (23:00). Midnight is outside.
    "Asia/Manila": { start: 9, end: 23 },

    // Canada (all listed): 9 AM–5 PM
    "America/Toronto": { start: 9, end: 17 },
    "America/Halifax": { start: 9, end: 17 },
    "America/Vancouver": { start: 9, end: 17 },
    "America/Edmonton": { start: 9, end: 17 },

    // Kenya, India, Mexico, Brazil: 9 AM–5 PM
    "Africa/Nairobi": { start: 9, end: 17 },
    "Asia/Kolkata": { start: 9, end: 17 },
    "America/Mexico_City": { start: 9, end: 17 },
    "America/Sao_Paulo": { start: 9, end: 17 }
  };

  /* ==========================================================
     ELEMENTS
     ========================================================== */

  const fromLoc    = document.getElementById("fromLoc");
  const toLoc      = document.getElementById("toLoc");
  const dateEl     = document.getElementById("date");
  const timeEl     = document.getElementById("time");
  const convertBtn = document.getElementById("convertBtn");

  const resultMain = document.getElementById("resultMain");
  const resultSub  = document.getElementById("resultSub");

  /* ==========================================================
     INITIAL SETUP
     ========================================================== */

  function initSelects() {
    for (const loc of LOCATIONS) {
      const o1 = document.createElement("option");
      o1.value = loc.tz;
      o1.textContent = loc.label;
      fromLoc.appendChild(o1);

      const o2 = document.createElement("option");
      o2.value = loc.tz;
      o2.textContent = loc.label;
      toLoc.appendChild(o2);
    }

    // Default: Ontario → Philippines
    fromLoc.value = "America/Toronto";
    toLoc.value   = "Asia/Manila";
  }

  function getLabel(tz) {
    return LOCATIONS.find(x => x.tz === tz)?.label || tz;
  }

  /* ==========================================================
     TIME HELPERS
     ========================================================== */

  function formatInTZ(dateObj, tz) {
    return new Intl.DateTimeFormat("en-US", {
      timeZone: tz,
      weekday: "short",
      year: "numeric",
      month: "short",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      hour12: true,
      timeZoneName: "short"
    }).format(dateObj);
  }

  // Interpret user-entered date/time in the "From" timezone (DST-safe)
  function buildInstant(fromTZ, y, m, d, h, min) {
    let dt = new Date(Date.UTC(y, m - 1, d, h, min, 0));

    for (let i = 0; i < 6; i++) {
      const parts = new Intl.DateTimeFormat("en-CA", {
        timeZone: fromTZ,
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        hour12: false
      }).formatToParts(dt);

      const get = t => parts.find(p => p.type === t)?.value;

      const cy = Number(get("year"));
      const cm = Number(get("month"));
      const cd = Number(get("day"));
      const ch = Number(get("hour"));
      const cmin = Number(get("minute"));

      const target  = Date.UTC(y, m - 1, d, h, min, 0);
      const current = Date.UTC(cy, cm - 1, cd, ch, cmin, 0);

      const diff = target - current;
      if (diff === 0) return dt;

      dt = new Date(dt.getTime() + diff);
    }

    return dt;
  }

  // Get hour in a given TZ for this instant (0–23)
  function getHourInTZ(dateObj, tz) {
    const parts = new Intl.DateTimeFormat("en-CA", {
      timeZone: tz,
      hour: "2-digit",
      hour12: false
    }).formatToParts(dateObj);

    return Number(parts.find(p => p.type === "hour")?.value);
  }

  function isWithinWorkingHours(tz, hour) {
    const window = WORK_WINDOWS[tz] || DEFAULT_WORK_WINDOW;
    return hour >= window.start && hour < window.end;
  }

  /* ==========================================================
     MAIN CONVERSION + WORKING HOURS CHECK
     ========================================================== */

  function convert() {
    if (!dateEl.value || !timeEl.value) {
      resultMain.textContent = "Please select a date and time first.";
      resultSub.textContent  = "";
      return;
    }

    const fromTZ = fromLoc.value;
    const toTZ   = toLoc.value;

    const [y, m, d] = dateEl.value.split("-").map(Number);
    const [h, min]  = timeEl.value.split(":").map(Number);

    const instant = buildInstant(fromTZ, y, m, d, h, min);

    const fromText = formatInTZ(instant, fromTZ);
    const toText   = formatInTZ(instant, toTZ);

    const fromLabel = getLabel(fromTZ);
    const toLabel   = getLabel(toTZ);

    const targetHour = getHourInTZ(instant, toTZ);
    const within = isWithinWorkingHours(toTZ, targetHour);

    const statusClass = within ? "good" : "bad";
    const statusText  = within ? "Within working hours" : "Outside working hours";

    resultMain.innerHTML =
      `In ${toLabel}, it’s <span class="${statusClass}">${toText}</span>.`;

    resultSub.innerHTML =
      `Status: <span class="${statusClass}">${statusText}</span><br>` +
      `You entered: <span class="mono">${fromText}</span> (${fromLabel})<br>` +
      `Converted to: <span class="mono">${toText}</span> (${toLabel})`;
  }

  /* ==========================================================
     DEFAULTS
     ========================================================== */

  function setNowInFromTZ() {
    const tz  = fromLoc.value;
    const now = new Date();

    const parts = new Intl.DateTimeFormat("en-CA", {
      timeZone: tz,
      year: "numeric",
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      hour12: false
    }).formatToParts(now);

    const get = t => parts.find(p => p.type === t)?.value;

    dateEl.value = `${get("year")}-${get("month")}-${get("day")}`;
    timeEl.value = `${get("hour")}:${get("minute")}`;
  }

  /* ==========================================================
     EVENTS
     ========================================================== */

  convertBtn.addEventListener("click", convert);

  fromLoc.addEventListener("change", () => {
    setNowInFromTZ();
  });

  /* ==========================================================
     INIT
     ========================================================== */

  initSelects();
  setNowInFromTZ();
</script>
</body>
</html>
